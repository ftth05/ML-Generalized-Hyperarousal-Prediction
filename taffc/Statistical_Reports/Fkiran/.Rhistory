Df_Exam <- Df_Exam %>% fill(Question.Name)
#Remove 2nd and 3rd attempts
# Means that take the all first attempts
Df_Exam <- Df_Exam[Df_Exam$Attempt==1,]
Df_Exam <- Df_Exam[Df_Exam$Question.Type !="Example",]
#Remove NAs
Df_Exam <- Df_Exam[!is.na(Df_Exam$Question.Type),]
Df_Exam<-droplevels(Df_Exam)
# Add NAs to S003 PP
Df_Exam$Perspiration[Df_Exam$ParticipantID == "S003"] <- NA
Df_Exam.SubSet <- Df_Exam.SubSet %>% fill(Question.Type)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(cowplot)
library(ggpubr)
library(readr)
library(gridExtra)
library(dplyr)
library(tidyr)
library(xtable)
library(statsr)
library(car)
library(kableExtra)
library(bestNormalize)
#setwd("/Users/f3tth/Desktop/SMR_6323_TA")
# Load the data
project_directory<-dirname(getwd())
raw_data_dir <- file.path(project_directory, 'Data')
filename = 'Affective_Math_Dataset_N12_NoiseReduced.csv'
Df <- read.csv(file.path(raw_data_dir,filename), stringsAsFactors = T)
#Df = read.csv(file.choose(),header = T)
# The data is in Data/Affective_Math_Dataset_N12_NoiseReduced.csv
# Exam data
Df_Exam <- Df[Df$Session=="Exam",]
#Remove unnecessary columns
Df_Exam <- subset(Df_Exam,
select=c(ParticipantID,Perspiration,HR.E4,HR.AW,Question.Type,Question.Name,Time,Attempt))
Df_Exam <- Df_Exam %>% fill(Question.Type)
Df_Exam <- Df_Exam %>% fill(Question.Name)
#Remove 2nd and 3rd attempts
# Means that take the all first attempts
Df_Exam <- Df_Exam[Df_Exam$Attempt==1,]
Df_Exam <- Df_Exam[Df_Exam$Question.Type !="Example",]
#Remove NAs
Df_Exam <- Df_Exam[!is.na(Df_Exam$Question.Type),]
Df_Exam<-droplevels(Df_Exam)
# Add NAs to S003 PP
Df_Exam$Perspiration[Df_Exam$ParticipantID == "S003"] <- NA
#Adding Perspiration_log column to the data
Df_Exam["Perspiration_log"] = log(Df_Exam$Perspiration)
# EDA
# 1. Summary statistics
# summary(Df_Exam$Attempt)
# sum(is.na(Df_Exam$Question.Type))
col_color = "lightblue"
Df_Exam.sym <-Df_Exam%>%
group_by(ParticipantID,Question.Type)%>%
summarise(
PP_mean=mean(Perspiration,na.rm=T),
HR.E4_mean=mean(HR.E4,na.rm=T),
HR.AW_mean=mean(HR.AW,na.rm=T),
q.solv.time = n(),.groups = "drop")
table(Df_Exam.sym$Question.Type)
colSums(!is.na(Df_Exam.sym))
pp.len = colSums(!is.na(Df_Exam.sym))[[3]]
hr.e4.len= colSums(!is.na(Df_Exam.sym))[[4]]
hr.aw.len = colSums(!is.na(Df_Exam.sym))[[5]]
#Df_Exam.sym$Perspiration[Df_Exam.sym$ParticipantID == "S003"] <- NA
p1 <-ggplot(data=Df_Exam.sym, aes(x=Question.Type, y=PP_mean)) +
geom_boxplot() +
theme_bw() +
#ggtitle(paste("PP Mean, n = 11"))+
ggtitle(bquote(paste(bar(PP * ""), ~italic("n"), " = " ,.(pp.len/3)))) +
geom_boxplot(fill = "lightblue") +
ylab("") + xlab("")  +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p2 <- ggplot(data=Df_Exam.sym, aes(x=Question.Type, y=HR.E4_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.E4 * ""), ~italic("n") ," = " ,.(hr.e4.len/3)))) +
geom_boxplot(fill = "orange") +
ylab("") + xlab("") + ylim(40,100)+
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p3 <- ggplot(data=Df_Exam.sym, aes(x=Question.Type, y=HR.AW_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.AW * ""), ~italic("n") ," = " ,.(hr.aw.len/3)))) +
geom_boxplot(fill = "lightgreen") +
ylab("") + xlab("") + ylim(40,100) +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
panel.A <- grid.arrange(p1, p2, p3,nrow = 1
)
shapiro.test(Df_Exam.sym$PP_mean)
shapiro.test(Df_Exam.sym$HR.E4_mean)
shapiro.test(Df_Exam.sym$HR.AW_mean)
bn <- bestNormalize(Df_Exam.sym$PP_mean)
bn
shapiro.test(bn$x.t)
# ----------------------------------------------------------------------------------
lev.pp.qt <- leveneTest(Df_Exam.sym$PP_mean ~ Df_Exam.sym$Question.Type, center=mean)
lev.hre4.qt <- leveneTest(Df_Exam.sym$HR.E4_mean ~ Df_Exam.sym$Question.Type, center=mean)
lev.hraw.qt <- leveneTest(Df_Exam.sym$HR.AW_mean ~ Df_Exam.sym$Question.Type, center=mean)
lev.pp.qt
lev.hre4.qt
lev.hraw.qt
PP.aov <- aov(Df_Exam.sym$PP_mean ~ Df_Exam.sym$Question.Type)
HR.E4.aov <- aov(Df_Exam.sym$HR.E4_mean ~ Df_Exam.sym$Question.Type)
HR.AW.aov <- aov(Df_Exam.sym$HR.AW_mean ~ Df_Exam.sym$Question.Type)
# PP.aov
summary(PP.aov)
#HR.E4.aov
summary(HR.E4.aov)
# HR.AW.aov
summary(HR.AW.aov)
par(mfrow=c(1,2))
par(mar=c(2,4,2,1))
plot(PP.aov,c(1,2))
mtext("PP Anova", side = 3, line = -1, outer = TRUE)
par(mfrow=c(1,2))
par(mar=c(2,4,2,1))
plot(HR.E4.aov,c(1,2))
mtext("HR.E4 Anova", side = 3, line = -1, outer = TRUE)
par(mfrow=c(1,2))
par(mar=c(2,4,2,1))
plot(HR.AW.aov,c(1,2))
mtext("HR.AW Anova", side = 3, line = -1, outer = TRUE)
col_color = "lightblue"
Df_Exam.sym2 <-Df_Exam%>%
group_by(ParticipantID,Question.Name,Question.Type)%>%
summarise(
PP_mean=mean(Perspiration,na.rm=T),
HR.E4_mean=mean(HR.E4,na.rm=T),
HR.AW_mean=mean(HR.AW,na.rm=T),
q.solv.time = n())
table(Df_Exam.sym2$Question.Type)
table(Df_Exam.sym2$Question.Name)
colSums(!is.na(Df_Exam.sym2))
pp.len = colSums(!is.na(Df_Exam.sym2))[[4]]
hr.e4.len= colSums(!is.na(Df_Exam.sym2))[[5]]
hr.aw.len = colSums(!is.na(Df_Exam.sym2))[[6]]
#Df_Exam.sym$Perspiration[Df_Exam.sym$ParticipantID == "S003"] <- NA
p1 <-ggplot(data=Df_Exam.sym2, aes(x=Question.Type, y=PP_mean)) +
geom_boxplot() +
theme_bw() +
#ggtitle(paste("PP Mean, n = 11"))+
ggtitle(bquote(paste(bar(PP * ""), ~italic("n"), " = " ,.(pp.len)))) +
geom_boxplot(fill = "lightblue") +
ylab("") + xlab("")  +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p2 <- ggplot(data=Df_Exam.sym2, aes(x=Question.Type, y=HR.E4_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.E4 * ""), ~italic("n") ," = " ,.(hr.e4.len)))) +
geom_boxplot(fill = "orange") +
ylab("") + xlab("") + ylim(40,100)+
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p3 <- ggplot(data=Df_Exam.sym2, aes(x=Question.Type, y=HR.AW_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.AW * ""), ~italic("n") ," = " ,.(hr.aw.len)))) +
geom_boxplot(fill = "lightgreen") +
ylab("") + xlab("") + ylim(40,100) +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
panel.A <- grid.arrange(p1, p2, p3,nrow = 1
)
shapiro.test(Df_Exam.sym2$PP_mean)
shapiro.test(Df_Exam.sym2$HR.E4_mean)
shapiro.test(Df_Exam.sym2$HR.AW_mean)
bn.pp <- bestNormalize(Df_Exam.sym2$PP_mean)
bn.pp
bn.hr.e4 <- bestNormalize(Df_Exam.sym2$HR.E4_mean)
bn.hr.e4
bn.hr.aw <- bestNormalize(Df_Exam.sym2$HR.AW_mean)
bn.hr.aw
# The best optimally transformed values.
shapiro.test(bn.pp$x.t)
# The best optimally transformed values.
shapiro.test(bn.hr.e4$x.t)
# The best optimally transformed values.
shapiro.test(bn.hr.aw$x.t)
#Add transformed data to df
Df_Exam.sym2$PP_mean_t <- bn.pp$x.t
Df_Exam.sym2$HR.E4_mean_t <- bn.hr.e4$x.t
Df_Exam.sym2$HR.AW_mean_t <- bn.hr.aw$x.t
#Df_Exam.sym$Perspiration[Df_Exam.sym$ParticipantID == "S003"] <- NA
p1 <-ggplot(data=Df_Exam.sym2, aes(x=Question.Type, y=PP_mean_t)) +
geom_boxplot() +
theme_bw() +
#ggtitle(paste("PP Mean, n = 11"))+
ggtitle(bquote(paste(bar(PP * ""), ~italic("n") ," = " ,.(pp.len)))) +
geom_boxplot(fill = "lightblue") +
ylab("") + xlab("")  +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p2 <- ggplot(data=Df_Exam.sym2, aes(x=Question.Type, y=HR.E4_mean_t)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.E4 * ""), ~italic("n") ," = " ,.(hr.e4.len)))) +
geom_boxplot(fill = "orange") +
ylab("") + xlab("") +# ylim(40,100)+
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p3 <- ggplot(data=Df_Exam.sym2, aes(x=Question.Type, y=HR.AW_mean_t)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.AW * ""), ~italic("n") ," = " ,.(hr.aw.len)))) +
geom_boxplot(fill = "lightgreen") +
ylab("") + xlab("") +# ylim(40,100) +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
panel.A <- grid.arrange(p1, p2, p3,nrow = 1
)
# ----------------------------------------------------------------------------------
lev.pp.qt <- leveneTest(Df_Exam.sym2$PP_mean ~ Df_Exam.sym2$Question.Type, center=mean)
lev.hre4.qt <- leveneTest(Df_Exam.sym2$HR.E4_mean ~ Df_Exam.sym2$Question.Type, center=mean)
lev.hraw.qt <- leveneTest(Df_Exam.sym2$HR.AW_mean ~ Df_Exam.sym2$Question.Type, center=mean)
lev.pp.qt
lev.hre4.qt
lev.hraw.qt
PP.aov <- aov(Df_Exam.sym2$PP_mean ~ Df_Exam.sym2$Question.Type)
HR.E4.aov <- aov(Df_Exam.sym2$HR.E4_mean ~ Df_Exam.sym2$Question.Type)
HR.AW.aov <- aov(Df_Exam.sym2$HR.AW_mean ~ Df_Exam.sym2$Question.Type)
# PP.aov
summary(PP.aov)
#HR.E4.aov
summary(HR.E4.aov)
# HR.AW.aov
summary(HR.AW.aov)
par(mfrow=c(1,2))
plot(PP.aov,c(1,2))
par(mar=c(2,4,2,1))
mtext("PP Anova", side = 3, line = -1, outer = TRUE)
par(mfrow=c(1,2))
par(mar=c(2,4,2,1))
plot(HR.E4.aov,c(1,2))
mtext("HR.E4 Anova", side = 3, line = -1, outer = TRUE)
par(mfrow=c(1,2))
par(mar=c(2,4,2,1))
plot(HR.AW.aov,c(1,2))
mtext("HR.AW Anova", side = 3, line = -1, outer = TRUE)
posthoc.pp <- TukeyHSD(PP.aov, conf.level=0.95)
posthoc.hr.aw <- TukeyHSD(HR.AW.aov, conf.level=0.95)
posthoc.pp
plot(posthoc.pp)
mtext("PP Posthoc", side = 2, line = -1, outer = TRUE)
posthoc.pp <- TukeyHSD(PP.aov, conf.level=0.95)
posthoc.hr.aw <- TukeyHSD(HR.AW.aov, conf.level=0.95)
posthoc.hr.aw
plot(posthoc.hr.aw)
mtext("HR.AW Posthoc", side = 2, line = -1, outer = TRUE)
Df_Exam.sym3 <-Df_Exam%>%
group_by(ParticipantID,Question.Name,Question.Type)%>%
summarise(
PP_mean=mean(Perspiration_log,na.rm=T),
HR.E4_mean=mean(HR.E4,na.rm=T),
HR.AW_mean=mean(HR.AW,na.rm=T),
q.solv.time = n())
dim(Df_Exam.sym3)
table(Df_Exam.sym3$Question.Type)
#table(Df_Exam.sym3$Question.Name)
colSums(!is.na(Df_Exam.sym3))
pp_log.len = colSums(!is.na(Df_Exam.sym3))[[9]]
colSums(!is.na(Df_Exam.sym3))
Df_Exam.sym3 <-Df_Exam%>%
group_by(ParticipantID,Question.Name,Question.Type)%>%
summarise(
PP_log_mean=mean(Perspiration_log,na.rm=T),
HR.E4_mean=mean(HR.E4,na.rm=T),
HR.AW_mean=mean(HR.AW,na.rm=T),
q.solv.time = n())
dim(Df_Exam.sym3)
table(Df_Exam.sym3$Question.Type)
#table(Df_Exam.sym3$Question.Name)
colSums(!is.na(Df_Exam.sym3))
pp_log.len = colSums(!is.na(Df_Exam.sym3))[[9]]
#table(Df_Exam.sym3$Question.Name)
colSums(!is.na(Df_Exam.sym3))
pp_log.len = colSums(!is.na(Df_Exam.sym3))[[4]]
hr.e4.len= colSums(!is.na(Df_Exam.sym3))[[5]]
hr.aw.len = colSums(!is.na(Df_Exam.sym3))[[6]]
Df_Exam.sym3 <-Df_Exam%>%
group_by(ParticipantID,Question.Name,Question.Type)%>%
summarise(
PP_log_mean=mean(Perspiration_log,na.rm=T),
HR.E4_mean=mean(HR.E4,na.rm=T),
HR.AW_mean=mean(HR.AW,na.rm=T),
q.solv.time = n())
dim(Df_Exam.sym3)
table(Df_Exam.sym3$Question.Type)
#table(Df_Exam.sym3$Question.Name)
colSums(!is.na(Df_Exam.sym3))
pp_log.len = colSums(!is.na(Df_Exam.sym3))[[4]]
hr.e4.len= colSums(!is.na(Df_Exam.sym3))[[5]]
hr.aw.len = colSums(!is.na(Df_Exam.sym3))[[6]]
#Df_Exam.sym$Perspiration[Df_Exam.sym$ParticipantID == "S003"] <- NA
p1 <-ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=Perspiration_log)) +
geom_boxplot() +
theme_bw() +
#ggtitle(paste("PP Mean, n = 11"))+
ggtitle(bquote(paste(bar(PP * ""), ~italic("n"), " = " ,.(pp_log.len)))) +
geom_boxplot(fill = "lightblue") +
ylab("") + xlab("")  +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p2 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.E4)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.E4 * ""), ~italic("n") ," = " ,.(hr.e4.len)))) +
geom_boxplot(fill = "orange") +
ylab("") + xlab("") + ylim(40,100)+
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p3 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.AW)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.AW * ""), ~italic("n") ," = " ,.(hr.aw.len)))) +
geom_boxplot(fill = "lightgreen") +
ylab("") + xlab("") + ylim(40,100) +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
panel.A <- grid.arrange(p1, p2, p3,nrow = 1
)
Df_Exam.sym3 <-Df_Exam%>%
group_by(ParticipantID,Question.Name,Question.Type)%>%
summarise(
PP_log_mean=mean(Perspiration_log,na.rm=T),
HR.E4_mean=mean(HR.E4,na.rm=T),
HR.AW_mean=mean(HR.AW,na.rm=T),
q.solv.time = n())
dim(Df_Exam.sym3)
table(Df_Exam.sym3$Question.Type)
#table(Df_Exam.sym3$Question.Name)
colSums(!is.na(Df_Exam.sym3))
pp_log.len = colSums(!is.na(Df_Exam.sym3))[[4]]
hr.e4.len= colSums(!is.na(Df_Exam.sym3))[[5]]
hr.aw.len = colSums(!is.na(Df_Exam.sym3))[[6]]
#Df_Exam.sym$Perspiration[Df_Exam.sym$ParticipantID == "S003"] <- NA
p1 <-ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=PP_log_mean)) +
geom_boxplot() +
theme_bw() +
#ggtitle(paste("PP Mean, n = 11"))+
ggtitle(bquote(paste(bar(PP * ""), ~italic("n"), " = " ,.(pp_log.len)))) +
geom_boxplot(fill = "lightblue") +
ylab("") + xlab("")  +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p2 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.E4_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.E4 * ""), ~italic("n") ," = " ,.(hr.e4.len)))) +
geom_boxplot(fill = "orange") +
ylab("") + xlab("") + ylim(40,100)+
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p3 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.AW_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.AW * ""), ~italic("n") ," = " ,.(hr.aw.len)))) +
geom_boxplot(fill = "lightgreen") +
ylab("") + xlab("") + ylim(40,100) +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
panel.A <- grid.arrange(p1, p2, p3,nrow = 1
)
#Df_Exam.sym$Perspiration[Df_Exam.sym$ParticipantID == "S003"] <- NA
p1 <-ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=PP_log_mean)) +
geom_boxplot() +
theme_bw() +
#ggtitle(paste("PP Mean, n = 11"))+
ggtitle(bquote(paste("ln",bar(PP * ""), ~italic("n"), " = " ,.(pp_log.len)))) +
geom_boxplot(fill = "lightblue") +
ylab("") + xlab("")  +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p2 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.E4_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.E4 * ""), ~italic("n") ," = " ,.(hr.e4.len)))) +
geom_boxplot(fill = "orange") +
ylab("") + xlab("") + ylim(40,100)+
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p3 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.AW_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.AW * ""), ~italic("n") ," = " ,.(hr.aw.len)))) +
geom_boxplot(fill = "lightgreen") +
ylab("") + xlab("") + ylim(40,100) +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
panel.A <- grid.arrange(p1, p2, p3,nrow = 1
)
#Df_Exam.sym$Perspiration[Df_Exam.sym$ParticipantID == "S003"] <- NA
p1 <-ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=PP_log_mean)) +
geom_boxplot() +
theme_bw() +
#ggtitle(paste("PP Mean, n = 11"))+
ggtitle(bquote(paste(bar(lnPP * ""), ~italic("n"), " = " ,.(pp_log.len)))) +
geom_boxplot(fill = "lightblue") +
ylab("") + xlab("")  +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p2 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.E4_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.E4 * ""), ~italic("n") ," = " ,.(hr.e4.len)))) +
geom_boxplot(fill = "orange") +
ylab("") + xlab("") + ylim(40,100)+
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p3 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.AW_mean)) +
geom_boxplot() +
theme_bw() +
ggtitle(bquote(paste(bar(HR.AW * ""), ~italic("n") ," = " ,.(hr.aw.len)))) +
geom_boxplot(fill = "lightgreen") +
ylab("") + xlab("") + ylim(40,100) +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
panel.A <- grid.arrange(p1, p2, p3,nrow = 1
)
shapiro.test(Df_Exam.sym2$PP_log_mean)
shapiro.test(Df_Exam.sym3$PP_log_mean)
shapiro.test(Df_Exam.sym3$HR.E4_mean)
shapiro.test(Df_Exam.sym3$HR.AW_mean)
shapiro.test(log(Df_Exam.sym3$PP_log_mean))
shapiro.test(Df_Exam.sym3$PP_log_mean)
shapiro.test(Df_Exam.sym3$HR.E4_mean)
shapiro.test(Df_Exam.sym3$HR.AW_mean)
shapiro.test(log(Df_Exam.sym3$PP_log_mean))
shapiro.test(sqrt(Df_Exam.sym3$PP_log_mean))
log(Df_Exam.sym3$PP_log_mean)
#install.packages('bestNormalize')
library(bestNormalize)
bn.pp <- bestNormalize(Df_Exam.sym3$PP_log_mean)
bn.pp
# The best optimally transformed values.
shapiro.test(bn.pp$x.t)
bn.hr.e4 <- bestNormalize(Df_Exam.sym3$HR.E4_mean)
bn.hr.e4
# The best optimally transformed values.
shapiro.test(bn.hr.e4$x.t)
bn.hr.aw <- bestNormalize(Df_Exam.sym3$HR.AW_mean)
bn.hr.aw
# The best optimally transformed values.
shapiro.test(bn.hr.aw$x.t)
#Add transformed data to df
Df_Exam.sym3$PP_log_mean_t <- bn.pp$x.t
Df_Exam.sym3$HR.E4_mean_t <- bn.hr.e4$x.t
Df_Exam.sym3$HR.AW_mean_t <- bn.hr.aw$x.t
#Df_Exam.sym$Perspiration[Df_Exam.sym$ParticipantID == "S003"] <- NA
p1 <-ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=PP_log_mean_t)) +
geom_boxplot() +
theme_bw() +
#ggtitle(paste("PP Mean, n = 11"))+
ggtitle(expression(paste(bar(PP * ""), ~italic("n") ," = 11"))) +
geom_boxplot(fill = "lightblue") +
ylab("") + xlab("")  +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p2 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.E4_mean_t)) +
geom_boxplot() +
theme_bw() +
ggtitle(expression(paste(bar(HR.E4 * ""), ~italic("n") ," = 12"))) +
geom_boxplot(fill = "orange") +
ylab("") + xlab("") +# ylim(40,100)+
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
p3 <- ggplot(data=Df_Exam.sym3, aes(x=Question.Type, y=HR.AW_mean_t)) +
geom_boxplot() +
theme_bw() +
ggtitle(expression(paste(bar(HR.AW * ""), ~italic("n") ," = 12"))) +
geom_boxplot(fill = "lightgreen") +
ylab("") + xlab("") +# ylim(40,100) +
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5, face = "bold"))
panel.A <- grid.arrange(p1, p2, p3,nrow = 1
)
lev.pp.qt <- leveneTest(Df_Exam.sym3$PP_log_mean_t ~ Df_Exam.sym3$Question.Type, center=mean)
lev.hre4.qt <- leveneTest(Df_Exam.sym3$HR.E4_mean_t ~ Df_Exam.sym3$Question.Type, center=mean)
lev.hraw.qt <- leveneTest(Df_Exam.sym3$HR.AW_mean_t ~ Df_Exam.sym3$Question.Type, center=mean)
lev.pp.qt
lev.hre4.qt
lev.hraw.qt
PP.aov <- aov(Df_Exam.sym3$PP_log_mean_t ~ Df_Exam.sym3$Question.Type)
HR.E4.aov <- aov(Df_Exam.sym3$HR.E4_mean_t ~ Df_Exam.sym3$Question.Type)
HR.AW.aov <- aov(Df_Exam.sym3$HR.AW_mean_t ~ Df_Exam.sym3$Question.Type)
summary(PP.aov)#[[1]][[5]][1]
summary(HR.E4.aov)# [[1]][[5]][1]
summary(HR.AW.aov)# [[1]][[5]][1]
par(mfrow=c(1,2))
plot(PP.aov,c(1,2))
mtext("PP Anova", side = 3, line = -1, outer = TRUE)
par(mfrow=c(1,2))
plot(HR.E4.aov,c(1,2))
mtext("HR.E4 Anova", side = 3, line = -1, outer = TRUE)
par(mfrow=c(1,2))
plot(HR.AW.aov,c(1,2))
mtext("HR.AW Anova", side = 3, line = -1, outer = TRUE)
posthoc.pp <- TukeyHSD(PP.aov, conf.level=0.95)
posthoc.hr.aw <- TukeyHSD(HR.AW.aov, conf.level=0.95)
posthoc.pp
posthoc.hr.aw
plot(posthoc.pp)
plot(posthoc.hr.aw)
